# PowerShell 腳本範本速查表

## 基本批次轉換

```powershell
# 一行版本
gci *.md | % { pandoc $_.Name -o ($_.BaseName + ".docx") }

# 完整版本
Get-ChildItem *.md | ForEach-Object {
    pandoc $_.Name -o ($_.BaseName + ".docx")
}
```

## 帶進度顯示

```powershell
$files = Get-ChildItem *.md
$total = $files.Count
$current = 0

$files | ForEach-Object {
    $current++
    Write-Host "[$current/$total] $($_.Name)"
    pandoc $_.Name -o ($_.BaseName + ".docx")
}
```

## 帶參數的腳本

```powershell
param(
    [string]$Format = "docx",
    [string]$OutputFolder = "output"
)

if (!(Test-Path $OutputFolder)) { mkdir $OutputFolder }

gci *.md | % {
    pandoc $_.Name -o "$OutputFolder\$($_.BaseName).$Format"
}
```

## 錯誤處理

```powershell
try {
    pandoc input.md -o output.docx
    Write-Host "成功" -ForegroundColor Green
} catch {
    Write-Host "失敗: $($_.Exception.Message)" -ForegroundColor Red
}
```

## 常用參數說明

| 參數 | 說明 |
|------|------|
| `$_.Name` | 檔案完整名稱（含副檔名）|
| `$_.BaseName` | 檔案名稱（不含副檔名）|
| `$_.FullName` | 完整路徑 |
| `$_.DirectoryName` | 所在資料夾 |
| `$_.Extension` | 副檔名 |

## 執行腳本

```powershell
# 設定執行原則（只需執行一次）
Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser

# 執行腳本
.\script.ps1

# 帶參數執行
.\script.ps1 -Format html -OutputFolder "D:\output"
```

---

> 💡 **提示**：使用 `gci` 取代 `Get-ChildItem`，`%` 取代 `ForEach-Object` 可以縮短指令
