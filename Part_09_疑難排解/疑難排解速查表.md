# 疑難排解速查表

## 常見錯誤與解決方法

### 檔案相關

| 錯誤訊息 | 原因 | 解決方法 |
|---------|------|---------|
| `does not exist` | 檔案不存在 | 確認路徑和檔名拼寫 |
| `permission denied` | 權限不足 | 檢查檔案權限或以管理員執行 |
| `already exists` | 輸出檔已存在 | 刪除或更名現有檔案 |

### YAML 相關

| 錯誤訊息 | 原因 | 解決方法 |
|---------|------|---------|
| `Could not parse YAML` | YAML 語法錯誤 | 檢查 `---` 標記和縮排 |
| `duplicate key` | 重複的鍵值 | 移除重複的欄位 |
| `invalid character` | 特殊字元問題 | 用引號包裹含特殊字元的值 |

### 編碼相關

| 錯誤訊息 | 原因 | 解決方法 |
|---------|------|---------|
| `invalid byte sequence` | 非 UTF-8 編碼 | 轉存為 UTF-8 |
| `Cannot decode` | 編碼不相容 | 指定正確的輸入編碼 |

### PDF 相關

| 錯誤訊息 | 原因 | 解決方法 |
|---------|------|---------|
| `pdflatex not found` | 缺少 LaTeX | 安裝 MiKTeX 或用其他方法 |
| `Package not found` | 缺少 LaTeX 套件 | 安裝所需套件 |
| `Font not found` | 缺少字型 | 安裝所需字型 |

---

## 環境設定

### 檢查 Pandoc 安裝
```powershell
pandoc --version
```

### 設定 PATH (PowerShell)
```powershell
# 加入使用者 PATH
$currentPath = [Environment]::GetEnvironmentVariable("Path", "User")
[Environment]::SetEnvironmentVariable("Path", "$currentPath;C:\Program Files\Pandoc", "User")
```

### 設定執行原則
```powershell
Set-ExecutionPolicy RemoteSigned -Scope CurrentUser
```

### 檢查 LaTeX
```powershell
pdflatex --version
```

---

## 診斷步驟

### 1. 簡化測試
```powershell
# 建立最簡單的測試檔
"Hello World" | Out-File test.md -Encoding UTF8

# 執行最簡單的轉換
pandoc test.md -o test.html
```

### 2. 使用詳細模式
```powershell
pandoc input.md -o output.docx --verbose
```

### 3. 檢查檔案編碼
```powershell
$bytes = [System.IO.File]::ReadAllBytes("file.md")
# UTF-8 BOM: EF BB BF
# UTF-16 LE: FF FE
```

### 4. 驗證 YAML
```yaml
---
title: 標題    # 冒號後要有空格
author: "作者" # 特殊字元用引號
date: 2024
---
```

---

## AI 提問範本

### 錯誤診斷
```
我在使用 Pandoc 時遇到問題。

環境：Windows 11, Pandoc 3.x

執行的指令：
pandoc input.md -o output.docx

錯誤訊息：
[貼上完整錯誤]

請幫我分析問題。
```

### 請求修正
```
這是我的腳本：
[貼上程式碼]

錯誤訊息：
[貼上錯誤]

請幫我修正。
```

### 理解原因
```
問題已修好，但我想了解：
為什麼 [某個設定/語法] 是必要的？
這樣以後可以避免類似問題。
```

---

## 預防建議

1. **統一使用 UTF-8** - 建立檔案時就設定好
2. **檔名避免空格** - 用底線或連字號
3. **使用相對路徑** - 方便專案移動
4. **先測試再批次** - 避免大量失敗
5. **定期備份** - 重要檔案多份保存
6. **記錄解決方案** - 建立個人知識庫

---

*建立日期：2024*
