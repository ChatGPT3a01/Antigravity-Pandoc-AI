# 課程完整指令速查表

## Pandoc 基礎指令

### 基本轉換
```bash
# Markdown → Word
pandoc input.md -o output.docx

# Markdown → HTML
pandoc input.md -o output.html

# Markdown → PDF (需要 LaTeX)
pandoc input.md -o output.pdf
```

### 指定格式
```bash
pandoc input.md -f markdown -t html -o output.html
pandoc input.md -f markdown -t docx -o output.docx
```

### 使用模板
```bash
pandoc input.md -o output.docx --reference-doc=template.docx
pandoc input.md -o output.html --template=template.html
```

### 獨立 HTML
```bash
pandoc input.md -o output.html --standalone
pandoc input.md -o output.html --standalone --self-contained
```

### 自訂樣式
```bash
pandoc input.md -o output.html --css=style.css
```

---

## PowerShell 腳本

### 批次轉換
```powershell
# 轉換所有 .md 到 .docx
Get-ChildItem *.md | ForEach-Object {
    $output = $_.BaseName + ".docx"
    pandoc $_.FullName -o $output
}
```

### 平行處理
```powershell
# PowerShell 7+ 支援
Get-ChildItem *.md | ForEach-Object -Parallel {
    pandoc $_.FullName -o ($_.BaseName + ".docx")
} -ThrottleLimit 4
```

### 只處理變更的檔案
```powershell
Get-ChildItem *.md | Where-Object {
    $output = $_.BaseName + ".docx"
    !(Test-Path $output) -or $_.LastWriteTime -gt (Get-Item $output).LastWriteTime
} | ForEach-Object {
    pandoc $_.FullName -o ($_.BaseName + ".docx")
}
```

### 錯誤處理
```powershell
try {
    pandoc input.md -o output.docx -ErrorAction Stop
} catch {
    Write-Host "錯誤: $_" -ForegroundColor Red
}
```

### 計時測量
```powershell
Measure-Command { pandoc input.md -o output.docx }
```

---

## AI 提示詞範本

### 文件整理
```
請幫我整理這份文件的結構，
加上適當的標題和段落分隔，
讓內容更有組織。
```

### 生成摘要
```
請幫我生成這份文件的重點摘要，
不超過 200 字，
列出 3-5 個關鍵要點。
```

### 校正潤飾
```
請幫我校正這份文件：
1. 修正錯字和標點
2. 潤飾語句使其更通順
3. 保持原意不變
```

### 產生腳本
```
請幫我寫一個 PowerShell 腳本，
可以批次將 .md 檔案轉換成 .docx，
並包含錯誤處理功能。
```

### 問題診斷
```
我執行 Pandoc 時遇到這個錯誤：
[錯誤訊息]

我的環境：Windows 11, Pandoc 3.x
執行的指令：[指令]

請幫我分析問題並提供解決方法。
```

---

## 常見錯誤速查

| 錯誤 | 原因 | 解決 |
|-----|------|-----|
| `does not exist` | 檔案不存在 | 檢查路徑 |
| `YAML header` | YAML 格式錯誤 | 檢查 `---` 和縮排 |
| `byte sequence` | 編碼問題 | 轉存為 UTF-8 |
| `pdflatex` | 缺少 LaTeX | 安裝 MiKTeX |
| `image` | 圖片路徑錯 | 檢查相對路徑 |

---

## 環境設定

### 檢查 Pandoc
```powershell
pandoc --version
```

### 設定 PATH
```powershell
$path = [Environment]::GetEnvironmentVariable("Path", "User")
[Environment]::SetEnvironmentVariable("Path", "$path;C:\Program Files\Pandoc", "User")
```

### 設定執行原則
```powershell
Set-ExecutionPolicy RemoteSigned -Scope CurrentUser
```

---

## YAML 標頭範本

```yaml
---
title: 文件標題
author: 作者名稱
date: 2024-01-01
lang: zh-TW
---
```

---

*Antigravity + Pandoc 課程速查表*
*持續更新中*
